{% extends 'base.html' %}
{% block content %}
{% load static %} 
<!--begin::Content wrapper-->
<div class="d-flex flex-column flex-column-fluid">
  <!--begin::Form-->
  <form id="kt_ecommerce_settings_general_form" action="" enctype="multipart/form-data" method="POST">
    {% csrf_token %}
    <!--begin::Toolbar-->
    <div id="kt_app_toolbar" class="app-toolbar py-3 py-lg-6">
      <!--begin::Toolbar container-->
      <div id="kt_app_toolbar_container" class="app-container container-xxl d-flex flex-stack">
        <!--begin::Page title-->
        <div class="page-title d-flex flex-column justify-content-center flex-wrap me-3">
          <!--begin::Title-->
          <h1 class="page-heading d-flex text-dark fw-bold fs-3 flex-column justify-content-center my-0">Avaliação checklist</h1>
          <!--end::Title-->
          <!--begin::Breadcrumb-->
          <ul class="breadcrumb breadcrumb-separatorless fw-semibold fs-7 my-0 pt-1">
            <!--begin::Item-->
            <li class="breadcrumb-item text-muted">
              <a href="#" class="text-muted text-hover-primary">Home</a>
            </li>
            <!--end::Item-->
            <!--begin::Item-->
            <li class="breadcrumb-item">
              <span class="bullet bg-gray-400 w-5px h-2px"></span>
            </li>
            <!--end::Item-->
            <!--begin::Item-->
            <li class="breadcrumb-item text-muted">Prontoticket</li>
            <!--end::Item-->
            <!--begin::Item-->
            <li class="breadcrumb-item">
              <span class="bullet bg-gray-400 w-5px h-2px"></span>
            </li>
            <!--end::Item-->
            <!--begin::Item-->
            <li class="breadcrumb-item text-muted">Checklist</li>
            <!--end::Item-->
            <!--begin::Item-->
            <li class="breadcrumb-item">
              <span class="bullet bg-gray-400 w-5px h-2px"></span>
            </li>
            <!--end::Item-->
            <!--begin::Item-->
            <li class="breadcrumb-item text-muted">Iniciar Avaliação</li>
            <!--end::Item-->
            <!--begin::Item-->
            <li class="breadcrumb-item">
              <span class="bullet bg-gray-400 w-5px h-2px"></span>
            </li>
            <!--end::Item-->
            <!--begin::Item-->
            <li class="breadcrumb-item text-muted">Escolhe setor</li>
            <!--end::Item-->
            <!--begin::Item-->
            <li class="breadcrumb-item">
              <span class="bullet bg-gray-400 w-5px h-2px"></span>
            </li>
            <!--end::Item-->
            <!--begin::Item-->
            <li class="breadcrumb-item text-muted">Escolhe local</li>
            <!--end::Item-->
            <!--begin::Item-->
            <li class="breadcrumb-item">
              <span class="bullet bg-gray-400 w-5px h-2px"></span>
            </li>
            <!--end::Item-->
            <!--begin::Item-->
            <li class="breadcrumb-item text-muted">Avaliação</li>
            <!--end::Item-->
          </ul>
          <!--end::Breadcrumb-->
        </div>
        <!--end::Page title-->

      </div>
      <!--end::Toolbar container-->
    </div>
    <!--end::Toolbar-->
    <!--begin::Content-->
    <div id="kt_app_content" class="app-content flex-column-fluid">
      <!--begin::Content container-->
      <div id="kt_app_content_container" class="app-container container-xxl">
        <!--begin::Contacts App- Add New Contact-->
        <div class="row g-7">
          <!--begin::Content-->
          <div class="col-xl-12">
            <!--begin::Contacts-->
            <div class="card card-flush h-lg-100" id="kt_contacts_main">
              <!--begin::Card header-->
              <div class="card-header pt-7" id="kt_chat_contacts_header">
                <!--begin::Card title-->
                <div class="card-title">
                  <i class="ki-duotone ki-badge fs-1 me-2">
                    <span class="path1"></span>
                    <span class="path2"></span>
                    <span class="path3"></span>
                    <span class="path4"></span>
                    <span class="path5"></span>
                  </i>
                  <h2>CHECKLIST:</h2>
                </div>
                <!--end::Card title-->
              </div>
              <!--end::Card header-->
              <!--begin::Card body-->
              <div class="card-body pt-5">
                <!--begin::Row-->
                <div class="row row-cols-1 row-cols-sm-2 rol-cols-md-1 row-cols-lg-2">
                  <!--begin::Col-->
                  <div class="col">
                    <!--begin::Input group-->
                    <div class="fv-row mb-7">
                      <!--begin::Label-->
                      <label class="fs-6 fw-semibold form-label mt-3">
                        <span>Nome do Avaliador:</span>
                      </label>
                      <!--end::Label-->
                      <div class="w-100">
                        <!--begin::Input-->
                        <input type="text" class="form-control form-control-solid" value="{{nm_colaborador}}" disabled/>
                        <!--end::Input-->
                      </div>
                    </div>
                    
                    <!--end::Input group-->
                  </div>
                  <!--end::Col-->
                  <!--begin::Col-->
                  <div class="col">
                    <!--begin::Input group-->
                    <div class="fv-row mb-7">
                      <!--begin::Label-->
                      <label class="fs-6 fw-semibold form-label mt-3">
                        <span>Setor:</span>
                      </label>
                      <!--end::Label-->
                      <div class="w-100">
                        <!--begin::Input-->
                        <input type="text" class="form-control form-control-solid" value="{{setor.name}}" disabled/>
                        <!--end::Input-->
                      </div>
                    </div>
                    <!--end::Input group-->
                  </div>
                  <!--end::Col-->
                </div>
                <!--end::Row-->
                <!--begin::Row-->
                <div class="row row-cols-1 row-cols-sm-3 rol-cols-md-1 row-cols-lg-3">
                  <!--begin::Col-->
                  <div class="col">
                    <!--begin::Input group-->
                    <div class="fv-row mb-7">
                      <!--begin::Label-->
                      <label class="fs-6 fw-semibold form-label mt-3">
                        <span>Empresa:</span>
                      </label>
                      <!--end::Label-->
                      <div class="w-100">
                        <!--begin::Input-->
                        <input type="text" class="form-control form-control-solid" value="Hospital Prontocardio" disabled/>
                        <!--end::Input-->
                      </div>
                    </div>
                    <!--end::Input group-->
                  </div>
                  <!--end::Col-->
                  <!--begin::Col-->
                  <div class="col">
                    <!--begin::Input group-->
                    <div class="fv-row mb-7">
                      <!--begin::Label-->
                      <label class="fs-6 fw-semibold form-label mt-3">
                        <span>Local:</span>
                      </label>
                      <!--end::Label-->
                      <div class="w-100">
                        <!--begin::Input-->
                        <input type="text" class="form-control form-control-solid" value="{{localGeral.local}}" disabled/>
                        <!--end::Input-->
                      </div>
                    </div>
                    <!--end::Input group-->
                  </div>
                  <!--end::Col-->
                  <!--begin::Col-->
                  <div class="col">
                    <!--begin::Input group-->
                    <div class="fv-row mb-7">
                      <!--begin::Label-->
                      <label class="fs-6 fw-semibold form-label mt-3">
                        <span>Data de Criação:</span>
                      </label>
                      <!--end::Label-->
                      <div class="w-100">
                        <!--begin::Input-->
                        <input type="text" class="form-control form-control-solid" value="{{data}}" disabled/>
                        <!--end::Input-->
                      </div>
                    </div>
                    <!--end::Input group-->
                  </div>
                  <!--end::Col-->
                </div>
                <!--end::Row-->
              </div>
              <!--end::Card body-->
            </div>
            <!--end::Contacts-->
          </div>
          <!--end::Content-->
        </div>
        <!--end::Contacts App- Add New Contact-->
      </div>
      <!--end::Content container-->
    </div>
    <!--end::Content-->
    <!--begin::Content-->
    <div id="kt_app_content" class="app-content flex-column-fluid">
      <!--begin::Content container-->
      <div id="kt_app_content_container" class="app-container container-xxl">
        <!--begin::Contacts App- Add New Contact-->
        <div class="row g-7">
          <!--begin::Content-->
          <div class="col-xl-12">
            <!--begin::Contacts-->
            <div class="card card-flush h-lg-100" id="kt_contacts_main">
              {% for item in itens %}
              {% if localGeral.id == item.local_id %}
              <!--begin::Contacts-->
              <div class="card card-flush h-lg-100" id="kt_contacts_main" style="box-shadow: 2px 2px 2px #888888;">
                <!--begin::Card header-->
                <div class="card-header pt-7" id="kt_chat_contacts_header">
                  <!--begin::Card title-->
                  <div class="card-title">
                      <h2 style="text-decoration: underline;">{{item.nome}}</h2>
                      <hr>
                  </div>
                  <!--end::Card title-->
                </div>              
                <!--end::Card header-->
                {% for subitem in subitens %}
                {% if subitem.item_id == item.id %}
                <!--begin::Card body-->
                <div class="card-body pt-5">
                  <!--begin::Row-->
                  <div class="row row-cols-2 row-cols-sm-2 rol-cols-md-1 row-cols-lg-2">
                    <!--begin::Col-->
                    <div class="col">
                      <!--begin::Input group-->
                      <div class="fv-row mb-7">
                        <!--begin::Label-->
                        <label class="fs-6 fw-semibold form-label mt-3">
                          <span>{{subitem.nome}}</span>
                        </label>
                        <!--end::Label-->
                      </div>
                      <!--end::Input group-->
                    </div>
                    <!--end::Col-->                 
                    <!--begin::Col-->
                    <div class="col">
                      <!--begin::Input group-->
                      <div class="d-flex justify-content-end" >
                        <input type="radio" class="btn btn-check btn-outline-dashed me-2 mb-2" name="pergunta{{subitem.id}}" id="sim{{subitem.id}}" autocomplete="off" value="1">
                        <label class="btn btn-light-success" for="sim{{subitem.id}}">Conforme</label>
            
                        <input type="radio" class="btn btn-check btn-outline-dashed me-2 mb-2" name="pergunta{{subitem.id}}" id="nao{{subitem.id}}" autocomplete="off" value="2" data-bs-toggle="modal" data-bs-target="#modalNaoConforme{{subitem.id}}">
                        <label class="btn btn-light-danger" for="nao{{subitem.id}}">Não Conforme</label>

                      </div>
                      <!--end::Input group-->
                      <div class="modal fade" id="basicModal" tabindex="-1">
                        <div class="modal-dialog">
                          <div class="modal-content">
                            <div class="modal-header">
                              <h5 class="modal-title">SUBITEM : {{subitem.nome}}</h5>
                              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                            </div>
                            <div class="modal-body">
                              <div class="input-group col-lg-12">
                                <div class="col-lg-12">
                                  <span class="col-lg-9" style="margin-bottom: 15px;">Comentário</span>
                                  <textarea class="form-control" aria-label="With textarea" name="comentario{{subitem.id}}" placeholder="Digite aqui para alterar o comentário"></textarea>
                                </div>
                              </div>
                              <hr>
                              <div class="input-group col-lg-12">
                                <div class="col-lg-12" data-lightbox="image-set">
                                  <span class="col-lg-9" style="margin-bottom: 15px;">Evidência</span>
                                  <input type="file" class="form-control" id="inputGroupFile02" name="evidencia{{subitem.id}}">
                                </div>
                                <br>
                              </div>
                            </div>
                            <div class="modal-footer">
                              <button type="reset" class="btn btn-secondary" >Limpar</button>
                              <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Salvar Mudanças</button>
                            </div>
                          </div>
                        </div>
                      </div><!-- End Basic Modal-->
                        
                      <div class="modal fade" tabindex="-1" id="modalNaoConforme{{subitem.id}}">
                        <div class="modal-dialog modal-dialog-centered">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h3 class="modal-title">SubItem: {{subitem.nome}} <br> <h5>Item: {{item.nome}}</h5></h3>
                                    <!--begin::Close-->
                                    <div class="btn btn-icon btn-sm btn-active-light-primary ms-2" data-bs-dismiss="modal" aria-label="Close">
                                        <i class="ki-duotone ki-cross fs-1"><span class="path1"></span><span class="path2"></span></i>
                                    </div>
                                    <!--end::Close-->
                                </div>
                                <div class="modal-body">
                                    <!-- Input de Imagem -->
                                    <div class="mb-3">
                                        <label for="imagemInput" class="form-label">Evidência:</label>
                                        <input type="file" class="form-control" id="imagemInput" accept="image/*" name="evidencia{{subitem.id}}">
                                    </div>
                    
                                    <!-- Campo de Comentário -->
                                    <div class="mb-3">
                                        <label for="comentarioInput" class="form-label">Comentário:</label>
                                        <textarea class="form-control" id="comentarioInput" rows="3" name="comentario{{subitem.id}}"></textarea>
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-light" data-bs-dismiss="modal">Fechar</button>
                                    <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Salvar alterações</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    

                    </div>
                    <!--end::Col-->      
                  </div>
                  <!--end::Row-->
                  <!--begin::Separator-->
                  <div class="separator mb-6"></div>
                  <!--end::Separator-->
                </div>
                <!--end::Card body-->
                {% endif %}
                {% endfor %}
              </div>
              <!--end::Contacts-->
              <br>
              {% endif %}
              {% endfor %}
            </div>
            <!--end::Contacts-->
          </div>
          <!--end::Content-->
        </div>
        <!--end::Contacts App- Add New Contact-->
      </div>
      <!--end::Content container-->
    </div>
    <!--end::Content-->
    <!--begin::Action buttons-->
    <div class="d-flex justify-content-center">
      <div class="modal fade" tabindex="-1" id="kt_modal_stacked_1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">Finalizar o item "{{localGeral.local}}" do setor - {{setor.name}} ?</h3>
        
                    <!--begin::Close-->
                    <div class="btn btn-icon btn-sm btn-active-light-primary ms-2" data-bs-dismiss="modal" aria-label="Close">
                        <i class="ki-duotone ki-cross fs-1"><span class="path1"></span><span class="path2"></span></i>
                    </div>
                    <!--end::Close-->
                </div>
        
                <div class="modal-body">
                    Ou deseja ir para outro local?
                    <br><br>
                    <button type="button" class="btn btn-primary" data-bs-stacked-modal="#kt_modal_stacked_2">
                        Clique aqui
                    </button>
                </div>
                
        
                <div class="modal-footer">
                    <button type="button" class="btn btn-light" data-bs-dismiss="modal">Fechar</button>
                    <button type="submit" class="btn btn-primary">Finalizar</button>
                </div>
            </div>
        </div>
      </div>
        
      <div class="modal fade" tabindex="-1" id="kt_modal_stacked_2">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">Selecione o próximo Local do setor - {{setor.name}}</h3>
        
                    <!--begin::Close-->
                    <div class="btn btn-icon btn-sm btn-active-light-primary ms-2" data-bs-dismiss="modal" aria-label="Close">
                        <i class="ki-duotone ki-cross fs-1"><span class="path1"></span><span class="path2"></span></i>
                    </div>
                    <!--end::Close-->
                </div>
                <div class="modal-body">
                  <select class="form-select" placeholder="Selecione a opção que deseja" name="prox_loc">
                      <option value="" selected disabled>Selecione uma opção</option> <!-- Opção vazia com informativo -->
                      {% for localSet in localSetor %}
                          <option value="{{ localSet.id }}">{{ localSet.local }}</option>
                      {% endfor %}
                  </select>
                </div>
        
                <div class="modal-footer">
                    <button type="button" class="btn btn-light" data-bs-dismiss="modal">Voltar</button>
                    <button type="submit" class="btn btn-primary">Finalizar e Inciar</button>
                </div>
            </div>
        </div>
      </div>
      <!--begin::Button-->
      <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#kt_modal_stacked_1">
        Finalizar
      </button>
      <!--end::Button-->
    </div>
    <!--end::Action buttons-->
  </form>
  <!--end::Form-->
</div>
<!--end::Content wrapper-->

{% endblock %}